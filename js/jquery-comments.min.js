//     jquery-comments.js 1.2.13
//     (c) 2017 Joona Tykkyl√§inen, Viima Solutions Oy
//     jquery-comments may be freely distributed under the MIT license.
//     For all details and documentation:
//     http://viima.github.io/jquery-comments/
!function(n){"function"==typeof define&&define.amd?define(["jquery"],n):"object"==typeof module&&module.exports?module.exports=function(e,t){return void 0===t&&(t="undefined"!=typeof window?require("jquery"):require("jquery")(e)),n(t),t}:n(jQuery)}(function(ne){var t,n={$el:null,commentsById:{},usersById:{},dataFetched:!1,currentSortKey:"",options:{},events:{click:"closeDropdowns","keydown [contenteditable]":"saveOnKeydown","focus [contenteditable]":"saveEditableContent","keyup [contenteditable]":"checkEditableContentForChange","paste [contenteditable]":"checkEditableContentForChange","input [contenteditable]":"checkEditableContentForChange","blur [contenteditable]":"checkEditableContentForChange","click .navigation li[data-sort-key]":"navigationElementClicked","click .navigation li.title":"toggleNavigationDropdown","click .commenting-field.main .textarea":"showMainCommentingField","click .commenting-field.main .close":"hideMainCommentingField","click .commenting-field .textarea":"increaseTextareaHeight","change .commenting-field .textarea":"increaseTextareaHeight textareaContentChanged","click .commenting-field:not(.main) .close":"removeCommentingField","click .commenting-field .send.enabled":"postComment","click .commenting-field .update.enabled":"putComment",'change .commenting-field .upload.enabled input[type="file"]':"fileInputChanged","click li.comment button.upvote":"upvoteComment","click li.comment button.downvote":"downvoteComment","click li.comment div.delete.enabled":"deleteComment","click li.comment .hashtag":"hashtagClicked","click li.comment .ping":"pingClicked","click li.comment ul.child-comments .toggle-all":"toggleReplies","click li.comment div.reply":"replyButtonClicked","click li.comment div.edit":"editButtonClicked",dragenter:"showDroppableOverlay","dragenter .droppable-overlay":"handleDragEnter","dragleave .droppable-overlay":"handleDragLeaveForOverlay","dragenter .droppable-overlay .droppable":"handleDragEnter","dragleave .droppable-overlay .droppable":"handleDragLeaveForDroppable","dragover .droppable-overlay":"handleDragOverForOverlay","drop .droppable-overlay":"handleDrop","click .dropdown.autocomplete":"stopPropagation","mousedown .dropdown.autocomplete":"stopPropagation","touchstart .dropdown.autocomplete":"stopPropagation"},getDefaultOptions:function(){return{profilePictureURL:"",currentUserIsAdmin:!1,currentUserId:null,spinnerIconURL:"",upvoteIconURL:"",downvoteIconURL:"",replyIconURL:"",uploadIconURL:"",attachmentIconURL:"",fileIconURL:"",noCommentsIconURL:"",textareaPlaceholderText:"Add to the discussion...",newestText:"Newest",oldestText:"Oldest",popularText:"Popular",attachmentsText:"Attachments",sendText:"Publish",replyText:"Reply",editText:"Edit",editedText:"Edited",youText:"You",saveText:"Save",deleteText:"Delete",newText:"New",viewAllRepliesText:"View all __replyCount__ replies",hideRepliesText:"Hide replies",loadMoreText:"Load more",noCommentsText:"No comments",noAttachmentsText:"No attachments",attachmentDropText:"Drop files here",textFormatter:function(e){return e},enableReplying:!0,enableEditing:!0,enableUpvoting:!0,enableDownvoting:!0,enableDeleting:!0,enableAttachments:!1,enableHashtags:!1,enablePinging:!1,enableDeletingCommentWithReplies:!1,enableNavigation:!0,postCommentOnEnter:!1,forceResponsive:!1,readOnly:!1,defaultNavigationSortKey:"newest",highlightColor:"#2793e6",deleteButtonColor:"#C9302C",scrollContainer:this.$el,roundProfilePictures:!0,textareaRows:3,textareaRowsOnFocus:5,textareaMaxRows:7,maxRepliesVisible:2,start:0,count:20,commentsCount:0,commentsLoaded:[],audioContext:null,fieldMappings:{id:"id",parent:"parent",created:"created",modified:"modified",content:"content",file:"file",fileName:"file_name",fileURL:"file_url",fileMimeType:"file_mime_type",pings:"pings",creator:"creator",fullname:"fullname",profileURL:"profile_url",profilePictureURL:"profile_picture_url",isNew:"is_new",createdByAdmin:"created_by_admin",createdByCurrentUser:"created_by_current_user",upvoteCount:"upvote_count",userHasUpvoted:"user_has_upvoted",downvoteCount:"downvote_count",userHasDownvoted:"user_has_downvoted"},getUsers:function(e,t){e([])},getComments:function(e,t){e([])},postComment:function(e,t,n){t(e)},putComment:function(e,t,n){t(e)},deleteComment:function(e,t,n){t()},upvoteComment:function(e,t,n){t(e)},downvoteComment:function(e,t,n){t(e)},hashtagClicked:function(e){},pingClicked:function(e){},uploadAttachments:function(e,t,n){t(e)},refresh:function(){},timeFormatter:function(e){return new Date(e).toLocaleDateString()}}},init:function(e,t){var n;this.$el=ne(t),this.$el.addClass("jquery-comments"),this.undelegateEvents(),this.delegateEvents(),n=navigator.userAgent||navigator.vendor||window.opera,(jQuery.browser=jQuery.browser||{}).mobile=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(n)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(n.substr(0,4)),ne.browser.mobile&&this.$el.addClass("mobile"),this.options=ne.extend(!0,{},this.getDefaultOptions(),e),this.options.readOnly&&this.$el.addClass("read-only"),this.currentSortKey=this.options.defaultNavigationSortKey,this.createCssDeclarations(),this.fetchDataAndRender()},delegateEvents:function(){this.bindEvents(!1)},undelegateEvents:function(){this.bindEvents(!0)},bindEvents:function(e){var t=e?"off":"on";for(var n in this.events){var i=n.split(" ")[0],a=n.split(" ").slice(1).join(" "),o=this.events[n].split(" ");for(var r in o)if(o.hasOwnProperty(r)){var s=this[o[r]];s=ne.proxy(s,this),""===a?this.$el[t](i,s):this.$el[t](i,a,s)}}},fetchDataAndRender:function(e){var n=this;e&&(this.options.start+=this.options.count),this.commentsById={},this.usersById={},this.$el.empty(),this.createHTML();var i=this.after(this.options.enablePinging?2:1,function(){n.dataFetched=!0,n.render()});if(this.options.getComments(function(e){0<n.options.commentsLoaded.length&&Array.prototype.push.apply(e,n.options.commentsLoaded);var t=(n.options.commentsLoaded=e).map(function(e){return n.createCommentModel(e)});n.sortComments(t,"oldest"),ne(t).each(function(e,t){n.addCommentToDataModel(t)}),i(),n.options.start+n.options.count<n.options.commentsCount&&n.$el.find(".load-more").show()},i,this.options.start,this.options.count),this.options.enablePinging){this.options.getUsers(function(e){ne(e).each(function(e,t){n.usersById[t.id]=t}),i()},i)}},fetchNext:function(){var n=this,t=this.createSpinner();this.$el.find("ul#comment-list").append(t);this.options.getComments(function(e){ne(e).each(function(e,t){n.createComment(t)}),t.remove()},function(){t.remove()})},createCommentModel:function(e){var t=this.applyInternalMappings(e);return t.childs=[],t},addCommentToDataModel:function(e){e.id in this.commentsById||(this.commentsById[e.id]=e).parent&&this.getOutermostParent(e.parent).childs.push(e.id)},updateCommentModel:function(e){ne.extend(this.commentsById[e.id],e)},render:function(){this.dataFetched&&(this.showActiveContainer(),this.createComments(),this.options.enableAttachments&&this.createAttachments(),this.$el.find("> .spinner").remove(),this.options.refresh())},showActiveContainer:function(){var e=this.$el.find(".navigation li[data-container-name].active").data("container-name"),t=this.$el.find('[data-container="'+e+'"]');t.siblings("[data-container]").hide(),t.show()},createComments:function(){var n=this;this.$el.find("#comment-list").remove();var i=ne("<ul/>",{id:"comment-list",class:"main"}),a=[],o=[];ne(this.getComments()).each(function(e,t){null==t.parent?a.push(t):o.push(t)}),this.sortComments(a,this.currentSortKey),a.reverse(),ne(a).each(function(e,t){n.addComment(t,i)}),this.sortComments(o,"oldest"),ne(o).each(function(e,t){n.addComment(t,i)}),this.$el.find('[data-container="comments"]').prepend(i)},createAttachments:function(){var n=this;this.$el.find("#attachment-list").remove();var i=ne("<ul/>",{id:"attachment-list",class:"main"}),e=this.getAttachments();this.sortComments(e,"newest"),e.reverse(),ne(e).each(function(e,t){n.addAttachment(t,i)}),this.$el.find('[data-container="attachments"]').prepend(i)},addComment:function(e,t){t=t||this.$el.find("#comment-list");var n=this.createCommentElement(e);if(e.parent){var i=t.find('.comment[data-id="'+e.parent+'"]');this.reRenderCommentActionBar(e.parent);var a=i.parents(".comment").last();0===a.length&&(a=i);var o=a.find(".child-comments"),r=o.find(".commenting-field");r.length?r.before(n):o.append(n),this.updateToggleAllButton(a)}else t.prepend(n)},addAttachment:function(e,t){t=t||this.$el.find("#attachment-list");var n=this.createCommentElement(e);t.prepend(n)},removeComment:function(e){var n=this,t=this.commentsById[e],i=this.getChildComments(t.id);if(ne(i).each(function(e,t){n.removeComment(t.id)}),t.parent){var a=this.getOutermostParent(t.parent),o=a.childs.indexOf(t.id);a.childs.splice(o,1)}delete this.commentsById[e];var r=this.$el.find('li.comment[data-id="'+e+'"]'),s=r.parents("li.comment").last();r.remove(),this.updateToggleAllButton(s)},uploadAttachments:function(e,t){var i=this;t||(t=this.$el.find(".commenting-field.main"));var n=t.find(".upload"),a=!t.hasClass("main"),o=e.length;if(o){var r=t.find(".textarea");n.removeClass("enabled");var s=this.createSpinner(),l=this.createSpinner();this.$el.find("ul#attachment-list").prepend(s),a?t.before(l):this.$el.find("ul#comment-list").prepend(l);var d=[];ne(e).each(function(e,t){var n=i.createCommentJSON(r);n.id+="-"+e,n.content="",n.file=t,n.fileName=t.name,n.fileURL="C:/fakepath/"+t.name,n.fileMimeType=t.type,n=i.applyExternalMappings(n),d.push(n)}),i.options.uploadAttachments(d,function(e){ne(e).each(function(e,t){var n=i.createCommentModel(t);i.addCommentToDataModel(n),i.addComment(n),i.addAttachment(n)}),e.length===o&&0===i.getTextareaContent(r).length&&t.find(".close").trigger("click"),n.addClass("enabled"),l.remove(),s.remove()},function(){n.addClass("enabled"),l.remove(),s.remove()})}n.find("input").val("")},updateToggleAllButton:function(e){if(null!=this.options.maxRepliesVisible){var t,n=e.find(".child-comments"),i=n.find(".comment"),a=n.find("li.toggle-all");if(i.removeClass("hidden-reply"),(t=0===this.options.maxRepliesVisible?i:i.slice(0,-this.options.maxRepliesVisible)).addClass("hidden-reply"),a.find("span.text").text()===this.options.textFormatter(this.options.hideRepliesText)&&t.addClass("visible"),i.length>this.options.maxRepliesVisible){if(!a.length){a=ne("<li/>",{class:"toggle-all highlight-font-bold"});var o=ne("<span/>",{class:"text"}),r=ne("<span/>",{class:"caret"});a.append(o).append(r),n.prepend(a)}this.setToggleAllButtonText(a,!1)}else a.remove()}},sortComments:function(e,a){var o=this;"popularity"===a?e.sort(function(e,t){var n=e.childs.length,i=t.childs.length;if(o.options.enableUpvoting&&(n+=e.upvoteCount+e.downvoteCount,i+=t.upvoteCount+t.downvoteCount),i!==n)return i-n;var a=new Date(e.created).getTime();return new Date(t.created).getTime()-a}):e.sort(function(e,t){var n=new Date(e.created).getTime(),i=new Date(t.created).getTime();return"oldest"===a?n-i:i-n})},sortUsers:function(e){e.sort(function(e,t){var n=e.fullname.toLowerCase().trim(),i=t.fullname.toLowerCase().trim();return n<i?-1:i<n?1:0})},sortAndReArrangeComments:function(e){var i=this.$el.find("#comment-list"),t=this.getComments().filter(function(e){return!e.parent});this.sortComments(t,e),ne(t).each(function(e,t){var n=i.find("> li.comment[data-id="+t.id+"]");i.append(n)})},showActiveSort:function(){var e=this.$el.find('.navigation li[data-sort-key="'+this.currentSortKey+'"]');this.$el.find(".navigation li").removeClass("active"),e.addClass("active");var t=this.$el.find(".navigation .title");if("attachments"!==this.currentSortKey)t.addClass("active"),t.find("header").html(e.first().html());else{var n=this.$el.find(".navigation ul.dropdown").children().first();t.find("header").html(n.html())}this.showActiveContainer()},forceResponsive:function(){this.$el.addClass("responsive")},closeDropdowns:function(){this.$el.find(".dropdown").hide()},saveOnKeydown:function(e){if(13===e.keyCode){var t=e.metaKey||e.ctrlKey;if(!this.options.postCommentOnEnter&&!t)return document.execCommand("insertHTML",!1,"<br><br>"),!1;ne(e.currentTarget).siblings(".control-row").find(".save").trigger("click"),e.stopPropagation(),e.preventDefault()}},saveEditableContent:function(e){var t=ne(e.currentTarget);t.data("before",t.html())},checkEditableContentForChange:function(e){var t=ne(e.currentTarget);t.data("before")!==t.html()&&(t.data("before",t.html()),t.trigger("change"))},navigationElementClicked:function(e){var t=ne(e.currentTarget).data().sortKey;"attachments"!==t&&this.sortAndReArrangeComments(t),this.currentSortKey=t,this.showActiveSort()},toggleNavigationDropdown:function(e){e.stopPropagation(),ne(e.currentTarget).find("~ .dropdown").toggle()},showMainCommentingField:function(e){var t=ne(e.currentTarget);t.siblings(".control-row").show(),t.parent().find(".close").show(),t.parent().find(".upload.inline-button").hide(),t.focus()},hideMainCommentingField:function(e){var t=ne(e.currentTarget),n=this.$el.find(".commenting-field.main .textarea"),i=this.$el.find(".commenting-field.main .control-row");this.clearTextarea(n),this.adjustTextareaHeight(n,!1),i.hide(),t.hide(),n.parent().find(".upload.inline-button").show(),n.blur()},increaseTextareaHeight:function(e){var t=ne(e.currentTarget);this.adjustTextareaHeight(t,!0)},textareaContentChanged:function(e){var t,n,i=ne(e.currentTarget),a=i.siblings(".control-row").find(".save");if(!i.find(".reply-to.tag").length)if(t=i.attr("data-comment")){var o=i.parents("li.comment");1<o.length&&(n=o.last().data("id"),i.attr("data-parent",n))}else n=i.parents("li.comment").last().data("id"),i.attr("data-parent",n);var r=i.parents(".commenting-field").first();i[0].scrollHeight>i.outerHeight()?r.addClass("scrollable"):r.removeClass("scrollable");var s=!0,l=this.getTextareaContent(i,!0);if((t=i.attr("data-comment"))&&this.commentsById[t]){var d,c=l!==this.commentsById[t].content;this.commentsById[t].parent&&(d=this.commentsById[t].parent.toString());var p=i.attr("data-parent")!==d;s=c||p}l.length&&s?a.addClass("enabled"):a.removeClass("enabled")},removeCommentingField:function(e){var t=ne(e.currentTarget);t.siblings(".textarea").attr("data-comment")&&t.parents("li.comment").first().removeClass("edit"),t.parents(".commenting-field").first().remove()},postComment:function(e){var t=this,n=ne(e.currentTarget),i=n.parents(".commenting-field").first(),a=i.find(".textarea");n.removeClass("enabled");var o=this.createCommentJSON(a);o=this.applyExternalMappings(o);this.options.postComment(o,function(e){t.createComment(e),i.find(".close").trigger("click")},function(){n.addClass("enabled")})},createComment:function(e){var t=this.createCommentModel(e);this.addCommentToDataModel(t),this.addComment(t)},putComment:function(e){var n=this,t=ne(e.currentTarget),i=t.parents(".commenting-field").first(),a=i.find(".textarea");t.removeClass("enabled");var o=ne.extend({},this.commentsById[a.attr("data-comment")]);ne.extend(o,{parent:a.attr("data-parent")||null,content:this.getTextareaContent(a),pings:this.getPings(a),modified:(new Date).getTime()}),o=this.applyExternalMappings(o);this.options.putComment(o,function(e){var t=n.createCommentModel(e);delete t.childs,n.updateCommentModel(t),i.find(".close").trigger("click"),n.reRenderComment(t.id)},function(){t.addClass("enabled")})},deleteComment:function(e){var t=this,n=ne(e.currentTarget),i=n.parents(".comment").first(),a=ne.extend({},this.commentsById[i.attr("data-id")]),o=a.id,r=a.parent;n.removeClass("enabled"),a=this.applyExternalMappings(a);this.options.deleteComment(a,function(){return t.removeComment(o),r&&t.reRenderCommentActionBar(r),t.commentsById},function(){n.addClass("enabled")})},hashtagClicked:function(e){var t=ne(e.currentTarget).attr("data-value");this.options.hashtagClicked(t)},pingClicked:function(e){var t=ne(e.currentTarget).attr("data-value");this.options.pingClicked(t)},fileInputChanged:function(e,t){var n=e.currentTarget.files,i=ne(e.currentTarget).parents(".commenting-field").first();n[0]&&(n[0].size<=2048e3?this.uploadAttachments(n,i):(ne(e.currentTarget).prop("value",""),window.alert("File size should be maximum 2MB.")))},upvoteComment:function(e){var t,n=this,i=ne(e.currentTarget).parents("li.comment").first().data().model,a=i.upvoteCount;t=i.userHasUpvoted?a-1:a+1,i.userHasUpvoted=!i.userHasUpvoted,i.upvoteCount=t,this.reRenderUpvotes(i.id);var o=ne.extend({},i);o=this.applyExternalMappings(o);this.options.upvoteComment(o,function(e){var t=n.createCommentModel(e);n.updateCommentModel(t),n.reRenderUpvotes(t.id),t.userHasDownvoted=!t.userHasDownvoted,t.downvoteCount=t.downvoteCount--,n.reRenderDownvotes(t.id)},function(){i.userHasUpvoted=!i.userHasUpvoted,i.upvoteCount=a,n.reRenderUpvotes(i.id)})},downvoteComment:function(e){var t,n=this,i=ne(e.currentTarget).parents("li.comment").first().data().model,a=i.downvoteCount;t=i.userHasDownvoted?a-1:a+1,i.userHasDownvoted=!i.userHasDownvoted,i.downvoteCount=t,this.reRenderDownvotes(i.id);var o=ne.extend({},i);o=this.applyExternalMappings(o);this.options.downvoteComment(o,function(e){var t=n.createCommentModel(e);n.updateCommentModel(t),n.reRenderDownvotes(t.id),t.userHasUpvoted=!t.userHasUpvoted,t.upvoteCount=t.upvoteCount--,n.reRenderUpvotes(t.id)},function(){i.userHasDownvoted=!i.userHasDownvoted,i.downvoteCount=a,n.reRenderDownvotes(i.id)})},toggleReplies:function(e){var t=ne(e.currentTarget);t.siblings(".hidden-reply").toggleClass("visible"),this.setToggleAllButtonText(t,!0)},replyButtonClicked:function(e){var t=ne(e.currentTarget),n=t.parents("li.comment").last(),i=t.parents(".comment").first().data().id,a=n.find(".child-comments > .commenting-field");if(a.length&&a.remove(),a.find(".textarea").attr("data-parent")!==i){a=this.createCommentingFieldElement(i),n.find(".child-comments").append(a);var o=a.find(".textarea");this.moveCursorToEnd(o);var r=this.options.scrollContainer.scrollTop(),s=r+a.position().top+a.outerHeight(),l=r+this.options.scrollContainer.outerHeight();if(l<s){var d=r+(s-l);this.options.scrollContainer.scrollTop(d)}}},editButtonClicked:function(e){var t=ne(e.currentTarget).parents("li.comment").first(),n=t.data().model;t.addClass("edit");var i=this.createCommentingFieldElement(n.parent,n.id);t.find(".comment-wrapper").first().append(i);var a=i.find(".textarea");a.attr("data-comment",n.id),a.append(this.getFormattedCommentContent(n.content,!0)),this.moveCursorToEnd(a)},showDroppableOverlay:function(e){this.options.enableAttachments&&(this.$el.find(".droppable-overlay").css("top",this.$el[0].scrollTop),this.$el.find(".droppable-overlay").show(),this.$el.addClass("drag-ongoing"))},handleDragEnter:function(e){var t=ne(e.currentTarget).data("dnd-count")||0;t++,ne(e.currentTarget).data("dnd-count",t),ne(e.currentTarget).addClass("drag-over")},handleDragLeave:function(e,t){var n=ne(e.currentTarget).data("dnd-count");n--,ne(e.currentTarget).data("dnd-count",n),0===n&&(ne(e.currentTarget).removeClass("drag-over"),t&&t())},handleDragLeaveForOverlay:function(e){var t=this;this.handleDragLeave(e,function(){t.hideDroppableOverlay()})},handleDragLeaveForDroppable:function(e){this.handleDragLeave(e)},handleDragOverForOverlay:function(e){e.stopPropagation(),e.preventDefault(),e.originalEvent.dataTransfer.dropEffect="copy"},hideDroppableOverlay:function(){this.$el.find(".droppable-overlay").hide(),this.$el.removeClass("drag-ongoing")},handleDrop:function(e){e.preventDefault(),ne(e.target).trigger("dragleave"),this.hideDroppableOverlay();var t=e.originalEvent.dataTransfer.files;t[0]&&(t[0].size<=2048e3?this.uploadAttachments(e.originalEvent.dataTransfer.files):window.alert("File size should be maximum 2MB."))},stopPropagation:function(e){e.stopPropagation()},createHTML:function(){var e=this.createMainCommentingFieldElement();this.$el.append(e),e.find(".control-row").hide(),e.find(".close").hide(),this.options.enableNavigation&&(this.$el.append(this.createNavigationElement()),this.showActiveSort());var t=this.createSpinner();this.$el.append(t);var n=ne("<div/>",{class:"data-container","data-container":"comments"});this.$el.append(n);var i=ne("<div/>",{class:"mdl-button mdl-button--colored load-more",text:this.options.textFormatter(this.options.loadMoreText)});n.append(i);var a=ne("<div/>",{class:"no-comments no-data",text:this.options.textFormatter(this.options.noCommentsText)}),o=ne("<i/>",{class:"fa fa-comments fa-2x"});if(this.options.noCommentsIconURL.length&&(o.css("background-image",'url("'+this.options.noCommentsIconURL+'")'),o.addClass("image")),a.prepend(ne("<br/>")).prepend(o),n.append(a),this.options.enableAttachments){var r=ne("<div/>",{class:"data-container","data-container":"attachments"});this.$el.append(r);var s=ne("<div/>",{class:"no-attachments no-data",text:this.options.textFormatter(this.options.noAttachmentsText)}),l=ne("<i/>",{class:"fa fa-paperclip fa-2x"});this.options.attachmentIconURL.length&&(l.css("background-image",'url("'+this.options.attachmentIconURL+'")'),l.addClass("image")),s.prepend(ne("<br/>")).prepend(l),r.append(s);var d=ne("<div/>",{class:"droppable-overlay"}),c=ne("<div/>",{class:"droppable-container"}),p=ne("<div/>",{class:"droppable"}),m=ne("<i/>",{class:"fa fa-upload fa-4x"});this.options.uploadIconURL.length&&(m.css("background-image",'url("'+this.options.uploadIconURL+'")'),m.addClass("image"));var h=ne("<div/>",{text:this.options.textFormatter(this.options.attachmentDropText)});p.append(m),p.append(h),d.html(c.html(p)).hide(),this.$el.append(d)}},createProfilePictureElement:function(e){var t;(t=e?ne("<img/>",{src:e}):ne("<i/>",{class:"fa fa-user"})).addClass("profile-picture");var n=ne("<div/>",{class:"profile-picture-wrapper"});return n.append(t),this.options.roundProfilePictures&&t.addClass("round"),n},createMainCommentingFieldElement:function(){return this.createCommentingFieldElement(void 0,void 0,!0)},createCommentingFieldElement:function(e,t,n){var i,l=this,a=ne("<div/>",{class:"commenting-field"});n&&a.addClass("main"),i=t?this.commentsById[t].profilePictureURL:this.options.profilePictureURL;var o=this.createProfilePictureElement(i),r=ne("<div/>",{class:"textarea-wrapper"}),s=ne("<div/>",{class:"control-row"}),d=ne("<div/>",{class:"textarea","data-placeholder":this.options.textFormatter(this.options.textareaPlaceholderText),contenteditable:!0});this.profilePictureWrapper=o,this.adjustTextareaHeight(d,!1);var c,p=ne('<i class="material-icons">close</i>');if(p.addClass("close inline-button"),t){c=this.options.textFormatter(this.options.saveText);var m=ne("<div/>",{class:"mdl-button delete",text:this.options.textFormatter(this.options.deleteText)}).css("color",this.options.deleteButtonColor);s.append(m),this.isAllowedToDelete(t)&&m.addClass("enabled")}else if(c=this.options.textFormatter(this.options.sendText),this.options.enableAttachments){var h=ne("<div/>",{class:"mdl-button enabled upload"}),u=ne('<i class="material-icons">attachment</i>'),f=ne("<input/>",{type:"file","data-role":"none"});ne.browser.mobile||f.attr("multiple","multiple"),this.options.uploadIconURL.length&&(u.css("background-image",'url("'+this.options.uploadIconURL+'")'),u.addClass("image")),h.append(u).append(f),s.append(h.clone()),n&&r.append(h.clone().addClass("inline-button"))}var g=ne("<div/>",{class:(t?"update":"send")+" mdl-button save",text:c}).css("color",this.options.highlightColor);if(s.prepend(g),r.append(p).append(d).append(s),a.append(o).append(r),e){d.attr("data-parent",e);var v=this.commentsById[e];if(v.parent){d.html("&nbsp;");var C="@"+v.fullname,b=this.createTagElement(C,"reply-to",v.creator);d.prepend(b)}}return this.options.enablePinging&&(d.textcomplete([{match:/(^|\s)@(([a-z√§√∂√º√ü]|\s)*)$/im,search:function(n,e){n=l.normalizeSpaces(n);var i=l.getPings(d),t=l.getUsers().filter(function(e){var t=e.id===l.options.currentUserId,n=-1!==i.indexOf(e.id);return!t&&!n});l.sortUsers(t),e(ne.map(t,function(e){var t=n.split(" "),a=e.fullname.split(" "),o=!0;return ne(t).each(function(e,t){var n=t.toLowerCase().trim(),i=!1;ne(a).each(function(e,t){0===t.toLowerCase().trim().indexOf(n)&&(i=!0)}),i||(o=!1)}),o?e:null}))},template:function(e){var t=ne("<div/>"),n=ne("<img/>",{src:e.profile_picture_url,class:"profile-picture round"}),i=ne("<div/>",{class:"details"}),a=ne("<div/>",{class:"name"}).html(e.fullname),o=ne("<div/>",{class:"email"}).html(e.email);return e.email?i.append(a).append(o):(i.addClass("no-email"),i.append(a)),t.append(n).append(i),t.html()},replace:function(e){return" "+l.createTagElement("@"+e.fullname,"ping",e.id)[0].outerHTML+" "}}],{appendTo:".jquery-comments",dropdownClassName:"dropdown autocomplete",maxCount:5,rightEdgeOffset:0}),ne.fn.textcomplete.Dropdown.prototype.render=function(e){var t=this._buildContents(e),n=ne.map(e,function(e){return e.value});if(e.length){var i=e[0].strategy;i.id?this.$el.attr("data-strategy",i.id):this.$el.removeAttr("data-strategy"),this._renderHeader(n),this._renderFooter(n),t&&(this._renderContents(t),this._fitToBottom(),this._fitToRight(),this._activateIndexedItem()),this._setScroll()}else this.noResultsMessage?this._renderNoResultsMessage(n):this.shown&&this.deactivate();var a=parseInt(this.$el.css("top"))+l.options.scrollContainer.scrollTop();this.$el.css("top",a);var o=this.$el.css("left");this.$el.css("left",0);var r=l.$el.width()-this.$el.outerWidth(),s=Math.min(r,parseInt(o));this.$el.css("left",s)}),a},createNavigationElement:function(){var e=ne("<ul/>",{class:"navigation"}),t=ne("<div/>",{class:"navigation-wrapper"});e.append(t);var n=ne("<li/>",{text:this.options.textFormatter(this.options.newestText),"data-sort-key":"newest","data-container-name":"comments"}),i=ne("<li/>",{text:this.options.textFormatter(this.options.popularText),"data-sort-key":"popularity","data-container-name":"comments"}),a=ne("<div/>",{class:"navigation-wrapper responsive"}),o=ne("<ul/>",{class:"dropdown"}),r=ne("<li/>",{class:"title"}),s=ne("<header/>");return r.append(s),a.append(r),a.append(o),e.append(a),t.append(n),o.append(n.clone()),(this.options.enableReplying||this.options.enableUpvoting)&&(t.append(i),o.append(i.clone())),this.options.forceResponsive&&this.forceResponsive(),e},createSpinner:function(){var e=ne("<div/>",{class:"spinner"}),t=ne("<i/>",{class:"fa fa-spinner fa-spin"});return this.options.spinnerIconURL.length&&(t.css("background-image",'url("'+this.options.spinnerIconURL+'")'),t.addClass("image")),e.html(t),e},createCommentElement:function(e){var t=ne("<li/>",{"data-id":e.id,class:"comment"}).data("model",e);e.createdByCurrentUser&&t.addClass("by-current-user"),e.createdByAdmin&&t.addClass("by-admin");var n=ne("<ul/>",{class:"child-comments"}),i=this.createCommentWrapperElement(e);return t.append(i),null==e.parent&&t.append(n),t},createCommentWrapperElement:function(n){var e=ne("<div/>",{class:"comment-wrapper"}),t=this.createProfilePictureElement(n.profilePictureURL),i=ne("<div/>",{class:"time",text:this.options.timeFormatter(n.created),"data-original":n.created}),a=n.createdByCurrentUser?this.options.textFormatter(this.options.youText):n.fullname,o=ne("<div/>",{class:"name"});if(n.profileURL){var r=ne("<a/>",{href:n.profileURL,text:a});o.html(r)}else o.text(a);if((n.createdByCurrentUser||n.createdByAdmin)&&o.addClass("highlight-font-bold"),n.parent){var s=this.commentsById[n.parent];if(s.parent){var l=ne("<span/>",{class:"reply-to",text:s.fullname}),d=ne("<i/>",{class:"fa fa-share"});this.options.replyIconURL.length&&(d.css("background-image",'url("'+this.options.replyIconURL+'")'),d.addClass("image")),l.prepend(d),o.append(l)}}if(n.isNew){var c=ne("<span/>",{class:"new highlight-background",text:this.options.newText});o.append(c)}var p=ne("<div/>",{class:"wrapper"}),m=ne("<div/>",{class:"content"}),h=(ne("<div/>",{class:"toggle-content"}),void 0!==n.fileURL);if(h){var u=null,f=null;if(n.fileMimeType){var g=n.fileMimeType.split("/");2===g.length&&(u=g[1],f=g[0])}r=ne("<a/>",{class:"attachment",href:n.fileURL,target:"_blank"});if("image"===f){var v=ne("<img/>",{src:n.fileURL});r.html(v)}else if("video"===f){var C=ne("<video/>",{src:n.fileURL,type:n.fileMimeType,controls:"controls"});r.html(C)}else if("audio"===f){var b=ne("<audio/>",{src:n.fileURL,type:n.fileMimeType,controls:"controls"});r.html(b);var w=ne("<canvas/>");r.prepend(w);var y=b[0],x=w[0];y.crossOrigin="anonymous";var T=this.options.audioContext.createMediaElementSource(y),R=this.options.audioContext.createAnalyser();x.width=window.innerWidth,x.height=window.innerHeight;var k=x.getContext("2d");T.connect(R),R.connect(this.options.audioContext.destination),R.fftSize=256;var U,D=R.frequencyBinCount,$=new Uint8Array(D),I=x.width,E=x.height,L=I/D*6,F=0,A=!0;function B(){if(!A){requestAnimationFrame(B),F=0,R.getByteFrequencyData($),k.fillStyle="#FFF",k.fillRect(0,0,I,E);for(var e=0;e<D;e++)U=3*$[e],k.fillStyle="#2196F1",k.fillRect(F,E-U,L-3,U),F+=L+1}}b.bind("play",function(){A=!1,B()}),b.bind("pause ended",function(){setTimeout(function(){A=!0},1e3)})}else{var M=["archive","audio","code","excel","image","movie","pdf","photo","picture","powerpoint","sound","video","word","zip"],H="fa fa-file-o";0<M.indexOf(u)?H="fa fa-file-"+u+"-o":0<M.indexOf(f)&&(H="fa fa-file-"+f+"-o");var P=n.fileName,O=ne("<div/>",{class:"attachment-wrapper"}),S=ne("<i/>",{class:H});this.options.fileIconURL.length&&(S.css("background-image",'url("'+this.options.fileIconURL+'")'),S.addClass("image"));var j=ne("<span/>",{text:P});O.append(S).append(j),r.prepend(O)}m.html(r)}else{var N;if(300<n.content.length){var z=n.content.substr(250,n.content.length-1);N=this.getFormattedCommentContent(n.content.substr(0,250+z.indexOf(" ")))+'...<span class="read-more-content"><span class="read-more-link read-more-'+n.id+'">Show more >></span></span>',m.html(N);var q=ne(".comments-container");q.off("click","span.read-more-"+n.id),q.on("click","span.read-more-"+n.id,_.bind(function(e){var t;return t=ne(e.currentTarget).hasClass("less")?this.getFormattedCommentContent(n.content.substr(0,250+z.indexOf(" ")))+'...<span class="read-more-content"><span class="read-more-link read-more-'+n.id+'">Show more >></span></span>':'<span class="comment-content">'+this.getFormattedCommentContent(n.content)+'</span><span class="less read-more-link read-more-'+n.id+'">Show less <<</span><span class="translate-link">Show translation</span>',m.html(t),!1},this))}else N='<span class="comment-content">'+this.getFormattedCommentContent(n.content)+'</span><span class="translate-link">Show translation</span>',m.html(N)}if(n.modified&&n.modified!==n.created){var W=this.options.timeFormatter(n.modified),K=ne("<time/>",{class:"edited",text:this.options.textFormatter(this.options.editedText)+" "+W,"data-original":n.modified});m.children().first().after(K)}var V=ne("<div/>",{class:"actions"}),Z=ne("<div/>",{class:"mdl-button action reply",type:"button",text:this.options.textFormatter(this.options.replyText)}),J=ne('<i class="material-icons">thumb_up</i>');this.options.upvoteIconURL.length&&(J.css("background-image",'url("'+this.options.upvoteIconURL+'")'),J.addClass("image"));var Q=this.createUpvoteElement(n),Y=ne('<i class="material-icons">thumb_down</i>');this.options.downvoteIconURL.length&&(Y.css("background-image",'url("'+this.options.downvoteIconURL+'")'),Y.addClass("image"));var G=this.createDownvoteElement(n);if(this.options.enableReplying&&V.append(Z),n.createdByCurrentUser||this.options.currentUserIsAdmin)if(h&&this.isAllowedToDelete(n.id)){var X=ne("<div/>",{class:"mdl-button action delete enabled",text:this.options.textFormatter(this.options.deleteText)});V.append(X)}else if(!h&&this.options.enableEditing){var ee=ne("<div/>",{class:"mdl-button action edit",text:this.options.textFormatter(this.options.editText)});V.append(ee)}this.options.enableDownvoting&&V.append(G),this.options.enableUpvoting&&V.append(Q),p.append(m),p.append(V);var te=ne("<div/>",{class:"comment-info-wrapper"});return te.append(t).append(o).append(i),e.append(te).append(p),e},createUpvoteElement:function(e){var t=ne('<i class="material-icons">thumb_up</i>');return this.options.upvoteIconURL.length&&(t.css("background-image",'url("'+this.options.upvoteIconURL+'")'),t.addClass("image")),ne("<button/>",{class:"action upvote"+(e.userHasUpvoted?" highlight-font":"")}).append(ne("<span/>",{text:e.upvoteCount,class:"upvote-count"})).append(t)},createDownvoteElement:function(e){var t=ne('<i class="material-icons">thumb_down</i>');return this.options.downvoteIconURL.length&&(t.css("background-image",'url("'+this.options.downvoteIconURL+'")'),t.addClass("image")),ne("<button/>",{class:"action downvote"+(e.userHasDownvoted?" red-highlight-font":"")}).append(ne("<span/>",{text:e.downvoteCount,class:"downvote-count"})).append(t)},createTagElement:function(e,t,n){var i=ne("<input/>",{class:"tag",type:"button","data-role":"none"});return t&&i.addClass(t),i.val(e),i.attr("data-value",n),i},reRenderComment:function(e){var i=this.commentsById[e],t=this.$el.find('li.comment[data-id="'+i.id+'"]'),a=this;t.each(function(e,t){var n=a.createCommentWrapperElement(i);ne(t).find(".comment-wrapper").first().replaceWith(n)})},reRenderCommentActionBar:function(e){var i=this.commentsById[e],t=this.$el.find('li.comment[data-id="'+i.id+'"]'),a=this;t.each(function(e,t){var n=a.createCommentWrapperElement(i);ne(t).find(".actions").first().replaceWith(n.find(".actions"))})},reRenderUpvotes:function(e){var i=this.commentsById[e],t=this.$el.find('li.comment[data-id="'+i.id+'"]'),a=this;t.each(function(e,t){var n=a.createUpvoteElement(i);ne(t).find(".upvote").first().replaceWith(n)})},reRenderDownvotes:function(e){var i=this.commentsById[e],t=this.$el.find('li.comment[data-id="'+i.id+'"]'),a=this;t.each(function(e,t){var n=a.createDownvoteElement(i);ne(t).find(".downvote").first().replaceWith(n)})},createCssDeclarations:function(){ne("head style.jquery-comments-css").remove(),this.createCss(".jquery-comments ul.navigation li.active:after {background: "+this.options.highlightColor+" !important;",NaN),this.createCss(".jquery-comments ul.navigation ul.dropdown li.active {background: "+this.options.highlightColor+" !important;",NaN),this.createCss(".jquery-comments .highlight-background {background: "+this.options.highlightColor+" !important;",NaN),this.createCss(".jquery-comments .highlight-font {color: "+this.options.highlightColor+" !important;}"),this.createCss(".jquery-comments .highlight-font-bold {color: "+this.options.highlightColor+" !important;font-weight: bold;}"),this.createCss(".jquery-comments .red-highlight-font {color: "+this.options.deleteButtonColor+" !important;}"),this.createCss(".jquery-comments .red-highlight-font-bold {color: "+this.options.deleteButtonColor+" !important;font-weight: bold;}")},createCss:function(e){var t=ne("<style/>",{type:"text/css",class:"jquery-comments-css",text:e});ne("head").append(t)},getComments:function(){var t=this;return Object.keys(this.commentsById).map(function(e){return t.commentsById[e]})},getUsers:function(){var t=this;return Object.keys(this.usersById).map(function(e){return t.usersById[e]})},getChildComments:function(t){return this.getComments().filter(function(e){return e.parent===t})},getAttachments:function(){return this.getComments().filter(function(e){return void 0!==e.fileURL})},getOutermostParent:function(e){for(var t,n=e;n=(t=this.commentsById[n]).parent,null!=t.parent;);return t},createCommentJSON:function(e){var t=(new Date).toISOString();return{id:"c"+(this.getComments().length+1),parent:e.attr("data-parent")||null,created:t,modified:t,content:this.getTextareaContent(e),pings:this.getPings(e),fullname:this.options.textFormatter(this.options.youText),profilePictureURL:this.options.profilePictureURL,createdByCurrentUser:!0,upvoteCount:0,downvoteCount:0,userHasUpvoted:!1,userHasDownvoted:!1}},isAllowedToDelete:function(n){if(this.options.enableDeleting){var i=!0;return this.options.enableDeletingCommentWithReplies||ne(this.getComments()).each(function(e,t){t.parent===n&&(i=!1)}),i}return!1},setToggleAllButtonText:function(n,e){var i=this,a=n.find("span.text"),t=n.find(".caret"),o=function(){var e=i.options.textFormatter(i.options.viewAllRepliesText),t=n.siblings(".comment").length;e=e.replace("__replyCount__",t),a.text(e)},r=this.options.textFormatter(this.options.hideRepliesText);e?(a.text()===r?o():a.text(r),t.toggleClass("up")):a.text()!==r&&o()},adjustTextareaHeight:function(e,t){var n=0<e.parents().siblings(".profile-picture-wrapper").length?e.parents().siblings(".profile-picture-wrapper"):this.profilePictureWrapper;e=ne(e);for(var i,a,o,r=1==t?this.options.textareaRowsOnFocus:this.options.textareaRows;void 0,o=2+r,e.css("height",o+"em"),n.css("height",o+"em"),r++,i=e[0].scrollHeight>e.outerHeight(),a=!1!==this.options.textareaMaxRows&&r>this.options.textareaMaxRows,i&&!a;);},clearTextarea:function(e){e.empty().trigger("input")},getTextareaContent:function(e,t){var n=e.clone();n.find(".reply-to.tag").remove(),n.find(".tag.hashtag").replaceWith(function(){return t?ne(this).val():"#"+ne(this).attr("data-value")}),n.find(".tag.ping").replaceWith(function(){return t?ne(this).val():"@"+ne(this).attr("data-value")});var i=ne("<pre/>").html(n.html());i.find("div, p, br").replaceWith(function(){return"\n"+this.innerHTML});var a=i.text().replace(/^\s+/g,"");return a=this.normalizeSpaces(a)},getFormattedCommentContent:function(e,t){var n=this.escape(e);return n=this.linkify(n),t&&(n=n.replace(/(?:\n)/g,"<br>")),n},getPings:function(e){return ne.map(e.find(".ping"),function(e){return parseInt(ne(e).attr("data-value"))})},moveCursorToEnd:function(e){if(e=ne(e)[0],ne(e).trigger("input"),ne(e).scrollTop(e.scrollHeight),void 0!==window.getSelection&&void 0!==document.createRange){var t=document.createRange();t.selectNodeContents(e),t.collapse(!1);var n=window.getSelection();n.removeAllRanges(),n.addRange(t)}else if(void 0!==document.body.createTextRange){var i=document.body.createTextRange();i.moveToElementText(e),i.collapse(!1),i.select()}e.focus()},escape:function(e){return ne("<pre/>").text(this.normalizeSpaces(e)).html()},normalizeSpaces:function(e){return e.replace(new RegExp("¬†","g")," ")},after:function(e,t){var n=this;return function(){if(0===--e)return t.apply(n,arguments)}},highlightTags:function(e,t){return this.options.enableHashtags&&(t=this.highlightHashtags(e,t)),this.options.enablePinging&&(t=this.highlightPings(e,t)),t},highlightHashtags:function(e,t){var a=this;if(-1!==t.indexOf("#")){t=t.replace(/(^|\s)#([a-z√§√∂√º√ü\d-_]+)/gim,function(e,t,n){return t+(i=n,a.createTagElement("#"+i,"hashtag",i)[0].outerHTML);var i})}return t},highlightPings:function(e,s){var l=this;if(-1!==s.indexOf("@")){var d="";return ne(e.pings).each(function(e,t){if(t in l.usersById){var n=l.usersById[t],i="@"+n.fullname,a=s.indexOf(i)+i.length,o=s.slice(0,a);d+=o.replace(i,(r=n,l.createTagElement("@"+r.fullname,"ping",r.id)[0].outerHTML)),s=s.slice(a)}var r}),d+=s}return s},linkify:function(e){var t,n,i,a;if(n=/(^|\s)((https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gim,i=/(^|\s)(www\.[\S]+(\b|$))/gim,a=/(^|\s)(([a-zA-Z0-9\-\_\.]+)@[a-zA-Z\_]+?(\.[a-zA-Z]{2,6})+)/gim,t=(t=(t=e.replace(n,'$1<a href="$2" target="_blank">$2</a>')).replace(i,'$1<a href="http://$2" target="_blank">$2</a>')).replace(a,'$1<a href="mailto:$2">$2</a>'),0<(e.match(/<a href/g)||[]).length){for(var o=e.split(/(<\/a>)/g),r=0;r<o.length;r++)null==o[r].match(/<a href/g)&&(o[r]=o[r].replace(n,'<a href="$1" target="_blank">$1</a>').replace(i,'$1<a href="http://$2" target="_blank">$2</a>').replace(a,'<a href="mailto:$1">$1</a>'));return o.join("")}return t},waitUntil:function(e,t){var n=this;e()?t():setTimeout(function(){n.waitUntil(e,t)},100)},applyInternalMappings:function(e){var t={},n=this.options.fieldMappings;for(var i in n)n.hasOwnProperty(i)&&(t[n[i]]=i);return this.applyMappings(t,e)},applyExternalMappings:function(e){var t=this.options.fieldMappings;return this.applyMappings(t,e)},applyMappings:function(e,t){var n={};for(var i in t){if(i in e)n[e[i]]=t[i]}return n}};ne.fn.comments=function(e){return this.each(function(){t=Object.create(n),ne.data(this,"comments",t),t.init(e||{},this)})},ne.fn.loadMore=function(){t.fetchDataAndRender(!0)}});
